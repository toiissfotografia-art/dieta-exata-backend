<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FINANCEIRO | DIETA EXATA</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --bg: #050505; --card: #0d0d0d; --green: #2ecc71; --gold: #ffac00; }
        body { background: var(--bg); color: white; font-family: 'Rajdhani'; margin: 0; display: flex; min-height: 100vh; }
        .sidebar { width: 250px; background: #000; border-right: 1px solid #222; padding: 30px 20px; display: flex; flex-direction: column; gap: 10px; }
        .nav-link { color: #888; text-decoration: none; padding: 12px; border-radius: 5px; font-family: 'Orbitron'; font-size: 11px; }
        .nav-link.active { background: #111; color: white; border-left: 3px solid var(--neon); }
        .main { flex: 1; padding: 40px; }
        h1 { font-family: 'Orbitron'; color: var(--neon); font-size: 22px; }

        .finance-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .fin-card { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid #222; text-align: center; }
        .fin-card h4 { margin: 0; color: #888; font-size: 12px; }
        .fin-card .value { font-family: 'Orbitron'; font-size: 24px; margin: 10px 0; }

        .history-box { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid #222; }
        .history-item { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #1a1a1a; font-size: 14px; }
        .type-bonus { color: var(--green); font-weight: bold; }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="logo" style="font-family:'Orbitron'; color:var(--neon); margin-bottom:30px; text-align:center;">DIETA EXATA</div>
        <a href="dashboard.html" class="nav-link">DASHBOARD</a>
        <a href="rede.html" class="nav-link">MINHA REDE</a>
        <a href="financeiro.html" class="nav-link active">FINANCEIRO</a>
        <a href="dashboard.html" class="nav-link">VOLTAR</a>
    </aside>

    <main class="main">
        <h1>EXTRATO FINANCEIRO</h1>
        
        <div class="finance-grid">
            <div class="fin-card"><h4>Saldo Atual</h4><div class="value" id="cur-balance" style="color:var(--green)">R$ 0,00</div></div>
            <div class="fin-card"><h4>Indicações Diretas</h4><div class="value" id="dir-earn" style="color:var(--neon)">R$ 0,00</div></div>
            <div class="fin-card"><h4>Bônus de Equipe</h4><div class="value" id="ind-earn" style="color:var(--gold)">R$ 0,00</div></div>
        </div>

        <div class="history-box">
            <h3 style="font-family:'Orbitron'; font-size:14px; margin-bottom:20px;">ÚLTIMAS MOVIMENTAÇÕES</h3>
            <div id="history-list">
                <p style="color:#666; font-size:12px;">Histórico de bônus processado via Smart Contract MMN.</p>
            </div>
        </div>
    </main>

    <script>
        const user = JSON.parse(localStorage.getItem('usuarioLogado'));

        async function loadFinance() {
            const res = await fetch('api_bridge.php?path=api/usuarios/todos');
            const users = await res.json();
            const u = users.find(u => u.email.toLowerCase() === user.email.toLowerCase());

            if (u) {
                document.getElementById('cur-balance').innerText = `R$ ${parseFloat(u.saldoDisponivel || 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                document.getElementById('dir-earn').innerText = `R$ ${parseFloat(u.ganhosDiretos || 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                document.getElementById('ind-earn').innerText = `R$ ${parseFloat(u.ganhosIndiretos || 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
            }
        }
        loadFinance();
    </script>
</body>
</html>